package dnslog

import (
	"fmt"
	"github.com/imroc/req/v3"
	"math/rand"
	"net/http"
	"strings"
	"time"
)

var client *req.Client
var jar http.CookieJar

func init() {
	client = req.C()
	client.SetCookieJar(jar)
}
func Get() string {
	rand.Seed(time.Now().Unix())
	url := fmt.Sprintf("http://www.dnslog.cn/getdomain.php?t=%f", rand.Float64())
	resp, err := client.R().Get(url)
	if err != nil {
		fmt.Println(err)
		return ""
	}
	if strings.Contains(resp.String(), "dnslog") {
		return resp.String()
	}
	return ""
}

func GetData() string {
	rand.Seed(time.Now().Unix())
	url := fmt.Sprintf("http://www.dnslog.cn/getrecords.php?t=%f", rand.Float64())
	resp, err := client.R().Get(url)
	if err != nil {
		fmt.Println(err)
		return ""
	}
	return resp.String()
}
